üìò –ü–∞–º—è—Ç–∫–∞ –ø–æ –Ω–∞–ø–∏—Å–∞–Ω–∏—é –∫–æ–º–∞–Ω–¥ –¥–ª—è MegaDoc Bot

üéØ –û–±—â–∏–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã

1. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–∞ –∫–æ–º–∞–Ω–¥—ã

–ö–∞–∂–¥–∞—è –∫–æ–º–∞–Ω–¥–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º —Ñ–∞–π–ª–µ –≤ –ø–∞–ø–∫–µ commands/ –∏ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é —Å —Å–∏–≥–Ω–∞—Ç—É—Ä–æ–π (bot, pool):

```javascript
// commands/exampleCommand.js
const registerCommand = require('../utils/registerCommand');

module.exports = (bot, pool) => {
  const handler = async (ctx) => {
    // –õ–æ–≥–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∫–æ–º–∞–Ω–¥—ã
  };

  // –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ–º –∫–æ–º–∞–Ω–¥—É –∏ –µ—ë –∞–ª–∏–∞—Å—ã
  registerCommand(bot, ['command', '–∫–æ–º–∞–Ω–¥–∞'], handler);
};
```

2. –ò–º–µ–Ω–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤

¬∑ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∞–Ω–≥–ª–∏–π—Å–∫–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è –≤ —Å—Ç–∏–ª–µ camelCase –∏–ª–∏ kebab-case
¬∑ –ù–∞–∑–≤–∞–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –æ—Ç—Ä–∞–∂–∞—Ç—å —Å—É—Ç—å –∫–æ–º–∞–Ω–¥—ã
¬∑ –ü—Ä–∏–º–µ—Ä: newBranch.js, edit-branch.js

3. –ú–Ω–æ–≥–æ—è–∑—ã—á–Ω–æ—Å—Ç—å

¬∑ –í—Å–µ –∫–æ–º–∞–Ω–¥—ã –¥–æ–ª–∂–Ω—ã –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –º–∏–Ω–∏–º—É–º 2 —è–∑—ã–∫–∞ (—Ä—É—Å—Å–∫–∏–π –∏ –∞–Ω–≥–ª–∏–π—Å–∫–∏–π)
¬∑ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é registerCommand –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∞–ª–∏–∞—Å–æ–≤
¬∑ –í—Å–µ —Ç–µ–∫—Å—Ç—ã –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø–µ—Ä–µ–≤–æ–¥–∏–º—ã–º–∏

```javascript
// –ü—Ä–∞–≤–∏–ª—å–Ω–æ
registerCommand(bot, ['structure', '—Å—Ç—Ä—É–∫—Ç—É—Ä–∞'], handler);

// –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ
registerCommand(bot, ['structure'], handler);
```

4. –†–∞–±–æ—Ç–∞ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö

¬∑ –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –∫ –ë–î –¥–æ–ª–∂–Ω—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–π pool
¬∑ –û–±—è–∑–∞—Ç–µ–ª—å–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –ë–î
¬∑ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç SQL-–∏–Ω—ä–µ–∫—Ü–∏–π

```javascript
// –ü—Ä–∞–≤–∏–ª—å–Ω–æ
await pool.execute('SELECT * FROM branches WHERE id = ?', [branchId]);

// –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ
await pool.execute(`SELECT * FROM branches WHERE id = ${branchId}`);
```

5. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

¬∑ –í—Å–µ –∫–æ–º–∞–Ω–¥—ã –¥–æ–ª–∂–Ω—ã –∏–º–µ—Ç—å try/catch –±–ª–æ–∫–∏
¬∑ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–ª–∂–µ–Ω –ø–æ–ª—É—á–∞—Ç—å –ø–æ–Ω—è—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö
¬∑ –í—Å–µ –æ—à–∏–±–∫–∏ –¥–æ–ª–∂–Ω—ã –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å—Å—è –≤ –∫–æ–Ω—Å–æ–ª—å

```javascript
try {
  // –õ–æ–≥–∏–∫–∞ –∫–æ–º–∞–Ω–¥—ã
} catch (error) {
  console.error('–û—à–∏–±–∫–∞ –≤ –∫–æ–º–∞–Ω–¥–µ X:', error);
  ctx.reply('‚ùå –ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –∫–æ–º–∞–Ω–¥—ã');
}
```

6. –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

¬∑ –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –≤—Å–µ –≤—Ö–æ–¥–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
¬∑ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –µ–¥–∏–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏-–≤–∞–ª–∏–¥–∞—Ç–æ—Ä—ã –∏–∑ utils/validators.js

```javascript
const { validateBranchId } = require('../utils/validators');

if (!validateBranchId(branchId)) {
  return ctx.reply('‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç ID –≤–µ—Ç–∫–∏');
}
```

üìù –ü—Ä–∏–º–µ—Ä –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –∫–æ–º–∞–Ω–¥—ã

```javascript
// commands/newBranch.js
const registerCommand = require('../utils/registerCommand');
const { validateBranchId } = require('../utils/validators');
const { getUserLanguage } = require('../utils/languageUtils');

module.exports = (bot, pool) => {
  const handleNewBranch = async (ctx) => {
    try {
      const args = ctx.message.text.split(' ').slice(1);
      const userLanguage = await getUserLanguage(ctx.from.id);
      
      // –í–∞–ª–∏–¥–∞—Ü–∏—è –∏ –ø–∞—Ä—Å–∏–Ω–≥ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤
      if (args.length < 1) {
        const message = userLanguage === 'ru' 
          ? '‚ùå –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: !new_branch ID [--parent PARENT_ID] [--description "–û–ø–∏—Å–∞–Ω–∏–µ"]'
          : '‚ùå Usage: !new_branch ID [--parent PARENT_ID] [--description "Description"]';
        return ctx.reply(message);
      }

      const branchId = args[0];
      
      if (!validateBranchId(branchId)) {
        const message = userLanguage === 'ru'
          ? '‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç ID. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–æ–ª—å–∫–æ –ª–∞—Ç–∏–Ω—Å–∫–∏–µ –±—É–∫–≤—ã, —Ü–∏—Ñ—Ä—ã, –¥–µ—Ñ–∏—Å –∏ –ø–æ–¥—á–µ—Ä–∫–∏–≤–∞–Ω–∏–µ.'
          : '‚ùå Invalid ID format. Use only Latin letters, numbers, hyphen and underscore.';
        return ctx.reply(message);
      }

      // –õ–æ–≥–∏–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –≤–µ—Ç–∫–∏...
      
      const successMessage = userLanguage === 'ru'
        ? `‚úÖ –í–µ—Ç–∫–∞ "${branchId}" —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω–∞!`
        : `‚úÖ Branch "${branchId}" created successfully!`;
      
      ctx.reply(successMessage);
      
    } catch (error) {
      console.error('–û—à–∏–±–∫–∞ –≤ –∫–æ–º–∞–Ω–¥–µ new_branch:', error);
      
      const errorMessage = await getUserLanguage(ctx.from.id) === 'ru'
        ? '‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –≤–µ—Ç–∫–∏'
        : '‚ùå Error creating branch';
      
      ctx.reply(errorMessage);
    }
  };

  // –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ–º –∫–æ–º–∞–Ω–¥—É –∏ –µ—ë –∞–ª–∏–∞—Å—ã
  registerCommand(bot, ['new_branch', '–Ω–æ–≤–∞—è_–≤–µ—Ç–∫–∞'], handleNewBranch);
};
```

üîß –£—Ç–∏–ª–∏—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

1. registerCommand - –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∫–æ–º–∞–Ω–¥ –∏ –∞–ª–∏–∞—Å–æ–≤
2. –í–∞–ª–∏–¥–∞—Ç–æ—Ä—ã –∏–∑ utils/validators.js - –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
3. –§—É–Ω–∫—Ü–∏–∏ –∏–∑ utils/languageUtils.js - –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ø–µ—Ä–µ–≤–æ–¥–∞–º–∏
4. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫ - –≤—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ console.error

üìã –ü—Ä–æ—Ü–µ—Å—Å –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤–æ–π –∫–æ–º–∞–Ω–¥—ã

1. –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª –≤ –ø–∞–ø–∫–µ commands/ –ø–æ –æ–±—Ä–∞–∑—Ü—É
2. –†–µ–∞–ª–∏–∑—É–π—Ç–µ –ª–æ–≥–∏–∫—É –∫–æ–º–∞–Ω–¥—ã —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫
3. –î–æ–±–∞–≤—å—Ç–µ –ø–æ–¥–¥–µ—Ä–∂–∫—É –º–Ω–æ–≥–æ—è–∑—ã—á–Ω–æ—Å—Ç–∏
4. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É
5. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∫–æ–º–∞–Ω–¥–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç—Å—è —Å–∏—Å—Ç–µ–º–æ–π

‚ùå –ß–µ–≥–æ –∏–∑–±–µ–≥–∞—Ç—å

1. –ù–µ –¥–æ–±–∞–≤–ª—è–π—Ç–µ –∫–æ–º–∞–Ω–¥—ã –≤—Ä—É—á–Ω—É—é –≤ index.js - —Å–∏—Å—Ç–µ–º–∞ –¥–µ–ª–∞–µ—Ç —ç—Ç–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
2. –ù–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ - –≤—Å—è –Ω–µ–æ–±—Ö–æ–¥–∏–º–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
3. –ù–µ –∏–≥–Ω–æ—Ä–∏—Ä—É–π—Ç–µ –æ—à–∏–±–∫–∏ - –≤—Å–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã
4. –ù–µ –∑–∞–±—ã–≤–∞–π—Ç–µ –ø—Ä–æ –º–Ω–æ–≥–æ—è–∑—ã—á–Ω–æ—Å—Ç—å - –≤—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø–µ—Ä–µ–≤–æ–¥–∏–º—ã–º–∏

–≠—Ç–∞ –ø–∞–º—è—Ç–∫–∞ –ø–æ–º–æ–∂–µ—Ç –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –µ–¥–∏–Ω—ã–π —Å—Ç–∏–ª—å –∫–æ–¥–∞ –∏ –æ–±–µ—Å–ø–µ—á–∏—Ç —Å—Ç–∞–±–∏–ª—å–Ω—É—é —Ä–∞–±–æ—Ç—É –±–æ—Ç–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤—ã—Ö –∫–æ–º–∞–Ω–¥! üöÄ

---

–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: –ü–æ–ª–Ω—ã–π –∫–æ–¥ —É—Ç–∏–ª–∏—Ç (registerCommand, validators, languageUtils) –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ —Ñ–∞–π–ª—ã –≤ –ø–∞–ø–∫–µ utils/ –ø–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º.
